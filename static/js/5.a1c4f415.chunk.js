(this["webpackJsonpreact-practice"]=this["webpackJsonpreact-practice"]||[]).push([[5],{117:function(e,t,a){"use strict";a.r(t);var c=a(6),s=a(1),r=a(15),n=a(9),i=a(16),l=a(110),u=a(7),h=a(17),o=a(0);t.default=function(){var e=Object(s.useRef)(null),t=Object(s.useRef)(null),a=Object(s.useRef)(null),d=Object(s.useContext)(n.a),j=Object(s.useContext)(r.a),b=Object(i.a)({fieldValue:"",chatMessages:[]}),f=Object(c.a)(b,2),m=f[0],p=f[1];return Object(s.useEffect)((function(){d.isChatOpen&&(t.current.focus(),j({type:"clearUnreadChatCount"}))}),[d.isChatOpen]),Object(s.useEffect)((function(){return e.current=Object(l.a)("https://reactpracticebackend.herokuapp.com/"),e.current.on("chatFromServer",(function(e){p((function(t){t.chatMessages.push(e)}))})),function(){return e.current.disconnect()}}),[]),Object(s.useEffect)((function(){a.current.scrollTop=a.current.scrollHeight,m.chatMessages.length&&!d.isChatOpen&&j({type:"incrementUnreadChatCount"})}),[m.chatMessages]),Object(o.jsxs)("div",{id:"chat-wrapper",className:"chat-wrapper shadow border-top border-left border-right "+(d.isChatOpen?"chat-wrapper--is-visible":""),children:[Object(o.jsxs)("div",{className:"chat-title-bar bg-primary",children:["Chat",Object(o.jsx)("span",{onClick:function(){return j({type:"closeChat"})},className:"chat-title-bar-close",children:Object(o.jsx)(h.b,{width:30,height:30,fill:"currentColor"})})]}),Object(o.jsx)("div",{id:"chat",className:"chat-log",ref:a,children:m.chatMessages.map((function(e,t){return e.username===d.user.username?Object(o.jsxs)("div",{className:"chat-self",children:[Object(o.jsx)("div",{className:"chat-message",children:Object(o.jsx)("div",{className:"chat-message-inner",children:e.message})}),Object(o.jsx)("img",{alt:"avatar",className:"chat-avatar avatar-tiny",src:e.avatar})]},t):Object(o.jsxs)("div",{className:"chat-other",children:[Object(o.jsx)(u.b,{to:"/profile/".concat(e.username),children:Object(o.jsx)("img",{alt:"avatar",className:"avatar-tiny",src:e.avatar})}),Object(o.jsx)("div",{className:"chat-message",children:Object(o.jsxs)("div",{className:"chat-message-inner",children:[Object(o.jsx)(u.b,{to:"/profile/".concat(e.username),children:Object(o.jsxs)("strong",{children:[e.username,": "]})}),e.message]})})]},t)}))}),Object(o.jsx)("form",{onSubmit:function(t){t.preventDefault(),e.current.emit("chatFromBrowser",{message:m.fieldValue,token:d.user.token}),p((function(e){e.chatMessages.push({message:e.fieldValue,username:d.user.username,avatar:d.user.avatar}),e.fieldValue=""}))},id:"chatForm",className:"chat-form border-top",children:Object(o.jsx)("input",{value:m.fieldValue,onChange:function(e){var t=e.target.value;p((function(e){e.fieldValue=t}))},ref:t,type:"text",className:"chat-field",id:"chatField",placeholder:"Type a message\u2026",autoComplete:"off"})})]})}}}]);
//# sourceMappingURL=5.a1c4f415.chunk.js.map