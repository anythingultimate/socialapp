{"version":3,"sources":["components/ViewSinglePost.jsx"],"names":["ViewSinglePost","id","useParams","useState","isLoading","setIsLoading","post","setPost","appState","useContext","StateContext","appDispatch","DispatchContext","navigate","useNavigate","useEffect","ourRequest","axios","CancelToken","source","a","get","cancelToken","token","response","data","console","log","fetchPost","cancel","title","date","Date","createdDate","dateFormatted","getMonth","getDate","getFullYear","window","confirm","delete","user","type","value","username","className","loggedIn","author","to","_id","data-tip","data-for","width","height","fill","onClick","alt","src","avatar","children","body","allowedElements"],"mappings":"6QAuJeA,UA3IQ,WAAO,IACpBC,EAAOC,cAAPD,GADmB,EAEOE,oBAAS,GAFhB,mBAEpBC,EAFoB,KAETC,EAFS,OAGHF,qBAHG,mBAGpBG,EAHoB,KAGdC,EAHc,KAIrBC,EAAWC,qBAAWC,KACtBC,EAAcF,qBAAWG,KACzBC,EAAW,IAAIC,IAuBrB,GArBAC,qBAAU,WACR,IAAMC,EAAaC,IAAMC,YAAYC,SADvB,4CAGd,4BAAAC,EAAA,+EAE2BH,IAAMI,IAAN,gBAAmBpB,GAAM,CAC9CqB,YAAaN,EAAWO,QAH9B,OAEUC,EAFV,OAKIjB,EAAQiB,EAASC,MACjBpB,GAAa,GANjB,gDAQIqB,QAAQC,IAAI,qDARhB,0DAHc,sBAed,OAfc,mCAcdC,GACO,WACLZ,EAAWa,YAGZ,KAEEzB,IAAcE,EACjB,OAAO,cAAC,IAAD,IAGT,GAAIF,EACF,OACE,cAAC,IAAD,CAAM0B,MAAM,MAAZ,SACE,cAAC,IAAD,MAIN,IAAMC,EAAO,IAAIC,KAAK1B,EAAK2B,aACrBC,EAAa,UACjBH,EAAKI,WAAa,EADD,YAEfJ,EAAKK,UAFU,YAEGL,EAAKM,eA3CA,4CAoD3B,sBAAAjB,EAAA,0DACqBkB,OAAOC,QACxB,2CAFJ,0CAM6BtB,IAAMuB,OAAN,gBAAsBvC,GAAM,CACjDwB,KAAM,CAAEF,MAAOf,EAASiC,KAAKlB,SAPrC,OAS4B,YAT5B,OASmBE,OAEXd,EAAY,CACV+B,KAAM,eACNC,MAAO,mCAIT9B,EAAS,YAAD,OAAaL,EAASiC,KAAKG,YAjB3C,gDAoBMlB,QAAQC,IAAI,wBApBlB,0DApD2B,sBA6E3B,OACE,eAAC,IAAD,CAAMG,MAAOxB,EAAKwB,MAAlB,UACE,sBAAKe,UAAU,iCAAf,UACE,6BAAKvC,EAAKwB,UAlCVtB,EAASsC,UACJtC,EAASiC,KAAKG,WAAatC,EAAKyC,OAAOH,UAmC1C,uBAAMC,UAAU,OAAhB,UACE,cAAC,IAAD,CACEG,GAAE,gBAAW1C,EAAK2C,IAAhB,SACFC,WAAS,OACTC,WAAS,OACTN,UAAU,oBAJZ,SAME,cAAC,IAAD,CAAUO,MAAO,GAAIC,OAAQ,GAAIC,KAAK,mBAExC,cAAC,IAAD,CAAcrD,GAAG,OAAO4C,UAAU,mBAAoB,IACtD,sBACEU,QA7Fe,2CA8FfL,WAAS,SACTC,WAAS,SACTN,UAAU,iCAJZ,SAME,cAAC,IAAD,CAAYO,MAAO,GAAIC,OAAQ,GAAIC,KAAK,UAE1C,cAAC,IAAD,CAAcrD,GAAG,SAAS4C,UAAU,yBAK1C,oBAAGA,UAAU,wBAAb,UACE,cAAC,IAAD,CAAMG,GAAE,mBAAc1C,EAAKyC,OAAOH,UAAlC,SACE,qBAAKY,IAAI,SAASX,UAAU,cAAcY,IAAKnD,EAAKyC,OAAOW,WAF/D,YAIY,IACV,cAAC,IAAD,CAAMV,GAAE,mBAAc1C,EAAKyC,OAAOH,UAAlC,SACGtC,EAAKyC,OAAOH,WACP,IAPV,MAQMV,KAEN,qBAAKW,UAAU,eAAf,SACE,cAAC,IAAD,CACEc,SAAUrD,EAAKsD,KACfC,gBAAiB,CACf,IACA,KACA,SACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA,KACA","file":"static/js/8.2ff90511.chunk.js","sourcesContent":["import Page from \"./ui/container/Page\";\nimport { Link, useParams, useNavigate } from \"react-router-dom\";\nimport { useContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport LoadingDotsIcon from \"./ui/LoadingDotsIcon\";\nimport ReactMarkdown from \"react-markdown\";\nimport { DeleteIcon, EditIcon } from \"./ui/AllSvg\";\nimport StateContext from \"../StateContext\";\nimport DispatchContext from \"../DispatchContext\";\nimport NotFound from \"./NotFound\";\nimport ReactTooltip from \"react-tooltip\";\n\nconst ViewSinglePost = () => {\n  const { id } = useParams();\n  const [isLoading, setIsLoading] = useState(true);\n  const [post, setPost] = useState();\n  const appState = useContext(StateContext);\n  const appDispatch = useContext(DispatchContext);\n  const navigate = new useNavigate();\n\n  useEffect(() => {\n    const ourRequest = axios.CancelToken.source();\n\n    async function fetchPost() {\n      try {\n        const response = await axios.get(`/post/${id}`, {\n          cancelToken: ourRequest.token,\n        });\n        setPost(response.data);\n        setIsLoading(false);\n      } catch (e) {\n        console.log(\"There was a problem or the request was cancelled.\");\n      }\n    }\n    fetchPost();\n    return () => {\n      ourRequest.cancel();\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  if (!isLoading && !post) {\n    return <NotFound />;\n  }\n\n  if (isLoading)\n    return (\n      <Page title=\"...\">\n        <LoadingDotsIcon />\n      </Page>\n    );\n\n  const date = new Date(post.createdDate);\n  const dateFormatted = `${\n    date.getMonth() + 1\n  }/${date.getDate()}/${date.getFullYear()}`;\n\n  function isOwner() {\n    if (appState.loggedIn) {\n      return appState.user.username === post.author.username;\n    }\n    return false;\n  }\n\n  async function deleteHandler() {\n    const areYouSure = window.confirm(\n      \"Do you really want to delete this post?\"\n    );\n    if (areYouSure) {\n      try {\n        const response = await axios.delete(`/post/${id}`, {\n          data: { token: appState.user.token },\n        });\n        if (response.data === \"Success\") {\n          // 1. display a flash message\n          appDispatch({\n            type: \"flashMessage\",\n            value: \"Post was successfully deleted.\",\n          });\n\n          // 2. redirect back to the current user's profile\n          navigate(`/profile/${appState.user.username}`);\n        }\n      } catch (e) {\n        console.log(\"There was a problem.\");\n      }\n    }\n  }\n\n  return (\n    <Page title={post.title}>\n      <div className=\"d-flex justify-content-between\">\n        <h2>{post.title}</h2>\n        {isOwner() && (\n          <span className=\"pt-2\">\n            <Link\n              to={`/post/${post._id}/edit`}\n              data-tip=\"Edit\"\n              data-for=\"edit\"\n              className=\"text-primary me-2\"\n            >\n              <EditIcon width={30} height={30} fill=\"currentColor\" />\n            </Link>\n            <ReactTooltip id=\"edit\" className=\"custom-tooltip\" />{\" \"}\n            <span\n              onClick={deleteHandler}\n              data-tip=\"Delete\"\n              data-for=\"delete\"\n              className=\"delete-post-button text-danger\"\n            >\n              <DeleteIcon width={30} height={30} fill=\"red\" />\n            </span>\n            <ReactTooltip id=\"delete\" className=\"custom-tooltip\" />\n          </span>\n        )}\n      </div>\n\n      <p className=\"text-muted small mb-4\">\n        <Link to={`/profile/${post.author.username}`}>\n          <img alt=\"avatar\" className=\"avatar-tiny\" src={post.author.avatar} />\n        </Link>\n        Posted by{\" \"}\n        <Link to={`/profile/${post.author.username}`}>\n          {post.author.username}\n        </Link>{\" \"}\n        on {dateFormatted}\n      </p>\n      <div className=\"body-content\">\n        <ReactMarkdown\n          children={post.body}\n          allowedElements={[\n            \"p\",\n            \"em\",\n            \"strong\",\n            \"h1\",\n            \"h2\",\n            \"h3\",\n            \"h4\",\n            \"h5\",\n            \"h6\",\n            \"ul\",\n            \"ol\",\n            \"li\",\n            \"a\",\n          ]}\n        />\n      </div>\n    </Page>\n  );\n};\n\nexport default ViewSinglePost;\n"],"sourceRoot":""}